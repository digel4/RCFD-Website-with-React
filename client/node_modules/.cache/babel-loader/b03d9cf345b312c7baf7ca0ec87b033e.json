{"ast":null,"code":"/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\n(function (global, factory) {\n  if (typeof module === 'object' && typeof module.exports === 'object') {\n    module.exports = global.document ? factory(global, true) : function (w) {\n      if (!w.document) {\n        throw new Error('SUNEDITOR_MODULES a window with a document');\n      }\n\n      return factory(w);\n    };\n  } else {\n    factory(global);\n  }\n})(typeof window !== 'undefined' ? window : this, function (window, noGlobal) {\n  const resizing = {\n    name: 'resizing',\n\n    /**\n     * @description Constructor\n     * Require context properties when resizing module\n        inputX: Element,\n        inputY: Element,\n        _container: null,\n        _cover: null,\n        _element: null,\n        _element_w: 1,\n        _element_h: 1,\n        _element_l: 0,\n        _element_t: 0,\n        _defaultSizeX: 'auto',\n        _defaultSizeY: 'auto',\n        _origin_w: core.options.imageWidth === 'auto' ? '' : core.options.imageWidth,\n        _origin_h: core.options.imageHeight === 'auto' ? '' : core.options.imageHeight,\n        _proportionChecked: true,\n        // -- select function --\n        _resizing: core.options.imageResizing,\n        _resizeDotHide: !core.options.imageHeightShow,\n        _rotation: core.options.imageRotation,\n        _onlyPercentage: core.options.imageSizeOnlyPercentage,\n        _ratio: false,\n        _ratioX: 1,\n        _ratioY: 1\n        _captionShow: true,\n        // -- when used caption (_captionShow: true) --\n        _caption: null,\n        _captionChecked: false,\n        captionCheckEl: null,\n     * @param {Object} core Core object \n     */\n    add: function (core) {\n      const icons = core.icons;\n      const context = core.context;\n      context.resizing = {\n        _resizeClientX: 0,\n        _resizeClientY: 0,\n        _resize_plugin: '',\n        _resize_w: 0,\n        _resize_h: 0,\n        _origin_w: 0,\n        _origin_h: 0,\n        _rotateVertical: false,\n        _resize_direction: '',\n        _move_path: null,\n        _isChange: false,\n        alignIcons: {\n          basic: icons.align_justify,\n          left: icons.align_left,\n          right: icons.align_right,\n          center: icons.align_center\n        }\n      };\n      /** resize controller, button */\n\n      let resize_div_container = this.setController_resize(core);\n      context.resizing.resizeContainer = resize_div_container;\n      context.resizing.resizeDiv = resize_div_container.querySelector('.se-modal-resize');\n      context.resizing.resizeDot = resize_div_container.querySelector('.se-resize-dot');\n      context.resizing.resizeDisplay = resize_div_container.querySelector('.se-resize-display');\n      let resize_button = this.setController_button(core);\n      context.resizing.resizeButton = resize_button;\n      let resize_handles = context.resizing.resizeHandles = context.resizing.resizeDot.querySelectorAll('span');\n      context.resizing.resizeButtonGroup = resize_button.querySelector('._se_resizing_btn_group');\n      context.resizing.rotationButtons = resize_button.querySelectorAll('._se_resizing_btn_group ._se_rotation');\n      context.resizing.percentageButtons = resize_button.querySelectorAll('._se_resizing_btn_group ._se_percentage');\n      context.resizing.alignMenu = resize_button.querySelector('.se-resizing-align-list');\n      context.resizing.alignMenuList = context.resizing.alignMenu.querySelectorAll('button');\n      context.resizing.alignButton = resize_button.querySelector('._se_resizing_align_button');\n      context.resizing.autoSizeButton = resize_button.querySelector('._se_resizing_btn_group ._se_auto_size');\n      context.resizing.captionButton = resize_button.querySelector('._se_resizing_caption_button');\n      /** add event listeners */\n\n      resize_div_container.addEventListener('mousedown', function (e) {\n        e.preventDefault();\n      });\n      resize_handles[0].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[1].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[2].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[3].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[4].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[5].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[6].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_handles[7].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n      resize_button.addEventListener('click', this.onClick_resizeButton.bind(core));\n      /** append html */\n\n      context.element.relative.appendChild(resize_div_container);\n      context.element.relative.appendChild(resize_button);\n      /** empty memory */\n\n      resize_div_container = null, resize_button = null, resize_handles = null;\n    },\n\n    /** resize controller, button (image, iframe, video) */\n    setController_resize: function (core) {\n      const resize_container = core.util.createElement('DIV');\n      resize_container.className = 'se-controller se-resizing-container';\n      resize_container.style.display = 'none';\n      resize_container.innerHTML = '' + '<div class=\"se-modal-resize\"></div>' + '<div class=\"se-resize-dot\">' + '<span class=\"tl\"></span>' + '<span class=\"tr\"></span>' + '<span class=\"bl\"></span>' + '<span class=\"br\"></span>' + '<span class=\"lw\"></span>' + '<span class=\"th\"></span>' + '<span class=\"rw\"></span>' + '<span class=\"bh\"></span>' + '<div class=\"se-resize-display\"></div>' + '</div>';\n      return resize_container;\n    },\n    setController_button: function (core) {\n      const lang = core.lang;\n      const icons = core.icons;\n      const resize_button = core.util.createElement(\"DIV\");\n      resize_button.className = \"se-controller se-controller-resizing\";\n      resize_button.innerHTML = '' + '<div class=\"se-arrow se-arrow-up\"></div>' + '<div class=\"se-btn-group _se_resizing_btn_group\">' + '<button type=\"button\" data-command=\"percent\" data-value=\"1\" class=\"se-tooltip _se_percentage\">' + '<span>100%</span>' + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.resize100 + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"percent\" data-value=\"0.75\" class=\"se-tooltip _se_percentage\">' + '<span>75%</span>' + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.resize75 + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"percent\" data-value=\"0.5\" class=\"se-tooltip _se_percentage\">' + '<span>50%</span>' + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.resize50 + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"auto\" class=\"se-btn se-tooltip _se_auto_size\">' + icons.auto_size + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.autoSize + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"rotate\" data-value=\"-90\" class=\"se-btn se-tooltip _se_rotation\">' + icons.rotate_left + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.rotateLeft + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"rotate\" data-value=\"90\" class=\"se-btn se-tooltip _se_rotation\">' + icons.rotate_right + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.rotateRight + '</span></span>' + '</button>' + '</div>' + '<div class=\"se-btn-group\" style=\"padding-top: 0;\">' + '<button type=\"button\" data-command=\"mirror\" data-value=\"h\" class=\"se-btn se-tooltip\">' + icons.mirror_horizontal + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.mirrorHorizontal + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"mirror\" data-value=\"v\" class=\"se-btn se-tooltip\">' + icons.mirror_vertical + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.mirrorVertical + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"onalign\" class=\"se-btn se-tooltip _se_resizing_align_button\">' + icons.align_justify + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.toolbar.align + '</span></span>' + '</button>' + '<div class=\"se-btn-group-sub sun-editor-common se-list-layer se-resizing-align-list\">' + '<div class=\"se-list-inner\">' + '<ul class=\"se-list-basic\">' + '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"basic\">' + icons.align_justify + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.basic + '</span></span>' + '</button></li>' + '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"left\">' + icons.align_left + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.left + '</span></span>' + '</button></li>' + '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"center\">' + icons.align_center + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.center + '</span></span>' + '</button></li>' + '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"right\">' + icons.align_right + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.right + '</span></span>' + '</button></li>' + '</ul>' + '</div>' + '</div>' + '<button type=\"button\" data-command=\"caption\" class=\"se-btn se-tooltip _se_resizing_caption_button\">' + icons.caption + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.caption + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"revert\" class=\"se-btn se-tooltip\">' + icons.revert + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.revertButton + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"update\" class=\"se-btn se-tooltip\">' + icons.modify + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.edit + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"delete\" class=\"se-btn se-tooltip\">' + icons.delete + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.remove + '</span></span>' + '</button>' + '</div>';\n      return resize_button;\n    },\n\n    /**\n     * @description Gets the width size\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     * @param {Element} element Target element\n     * @param {Element} cover Cover element (FIGURE)\n     * @param {Element} container Container element (DIV.se-component)\n     * @returns {String}\n     */\n    _module_getSizeX: function (contextPlugin, element, cover, container) {\n      if (!element) element = contextPlugin._element;\n      if (!cover) cover = contextPlugin._cover;\n      if (!container) container = contextPlugin._container;\n      if (!element) return '';\n      return !/%$/.test(element.style.width) ? element.style.width : (container && this.util.getNumber(container.style.width, 2) || 100) + '%';\n    },\n\n    /**\n     * @description Gets the height size\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     * @param {Element} element Target element\n     * @param {Element} cover Cover element (FIGURE)\n     * @param {Element} container Container element (DIV.se-component)\n     * @returns {String}\n     */\n    _module_getSizeY: function (contextPlugin, element, cover, container) {\n      if (!element) element = contextPlugin._element;\n      if (!cover) cover = contextPlugin._cover;\n      if (!container) container = contextPlugin._container;\n      if (!container || !cover) return element && element.style.height || '';\n      return this.util.getNumber(cover.style.paddingBottom, 0) > 0 && !this.context.resizing._rotateVertical ? cover.style.height : !/%$/.test(element.style.height) || !/%$/.test(element.style.width) ? element.style.height : (container && this.util.getNumber(container.style.height, 2) || 100) + '%';\n    },\n\n    /**\n     * @description Called at the \"openModify\" to put the size of the current target into the size input element.\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     * @param {Object} pluginObj Plugin object\n     */\n    _module_setModifyInputSize: function (contextPlugin, pluginObj) {\n      const percentageRotation = contextPlugin._onlyPercentage && this.context.resizing._rotateVertical;\n      contextPlugin.proportion.checked = contextPlugin._proportionChecked = contextPlugin._element.getAttribute('data-proportion') !== 'false';\n      let x = percentageRotation ? '' : this.plugins.resizing._module_getSizeX.call(this, contextPlugin);\n      if (x === contextPlugin._defaultSizeX) x = '';\n      if (contextPlugin._onlyPercentage) x = this.util.getNumber(x, 2);\n      contextPlugin.inputX.value = x;\n      pluginObj.setInputSize.call(this, 'x');\n\n      if (!contextPlugin._onlyPercentage) {\n        let y = percentageRotation ? '' : this.plugins.resizing._module_getSizeY.call(this, contextPlugin);\n        if (y === contextPlugin._defaultSizeY) y = '';\n        if (contextPlugin._onlyPercentage) y = this.util.getNumber(y, 2);\n        contextPlugin.inputY.value = y;\n      }\n\n      contextPlugin.inputX.disabled = percentageRotation ? true : false;\n      contextPlugin.inputY.disabled = percentageRotation ? true : false;\n      contextPlugin.proportion.disabled = percentageRotation ? true : false;\n      pluginObj.setRatio.call(this);\n    },\n\n    /**\n     * @description It is called in \"setInputSize\" (input tag keyupEvent), \n     * checks the value entered in the input tag, \n     * calculates the ratio, and sets the calculated value in the input tag of the opposite size.\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     * @param {String} xy 'x': width, 'y': height\n     */\n    _module_setInputSize: function (contextPlugin, xy) {\n      if (contextPlugin._onlyPercentage) {\n        if (xy === 'x' && contextPlugin.inputX.value > 100) contextPlugin.inputX.value = 100;\n        return;\n      }\n\n      if (contextPlugin.proportion.checked && contextPlugin._ratio && /\\d/.test(contextPlugin.inputX.value) && /\\d/.test(contextPlugin.inputY.value)) {\n        const xUnit = contextPlugin.inputX.value.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n        const yUnit = contextPlugin.inputY.value.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n        if (xUnit !== yUnit) return;\n        const dec = xUnit === '%' ? 2 : 0;\n\n        if (xy === 'x') {\n          contextPlugin.inputY.value = this.util.getNumber(contextPlugin._ratioY * this.util.getNumber(contextPlugin.inputX.value, dec), dec) + yUnit;\n        } else {\n          contextPlugin.inputX.value = this.util.getNumber(contextPlugin._ratioX * this.util.getNumber(contextPlugin.inputY.value, dec), dec) + xUnit;\n        }\n      }\n    },\n\n    /**\n     * @description It is called in \"setRatio\" (input and proportionCheck tags changeEvent), \n     * checks the value of the input tag, calculates the ratio, and resets it in the input tag.\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     */\n    _module_setRatio: function (contextPlugin) {\n      const xValue = contextPlugin.inputX.value;\n      const yValue = contextPlugin.inputY.value;\n\n      if (contextPlugin.proportion.checked && /\\d+/.test(xValue) && /\\d+/.test(yValue)) {\n        const xUnit = xValue.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n        const yUnit = yValue.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n\n        if (xUnit !== yUnit) {\n          contextPlugin._ratio = false;\n        } else if (!contextPlugin._ratio) {\n          const x = this.util.getNumber(xValue, 0);\n          const y = this.util.getNumber(yValue, 0);\n          contextPlugin._ratio = true;\n          contextPlugin._ratioX = x / y;\n          contextPlugin._ratioY = y / x;\n        }\n      } else {\n        contextPlugin._ratio = false;\n      }\n    },\n\n    /**\n     * @description Revert size of element to origin size (plugin._origin_w, plugin._origin_h)\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     */\n    _module_sizeRevert: function (contextPlugin) {\n      if (contextPlugin._onlyPercentage) {\n        contextPlugin.inputX.value = contextPlugin._origin_w > 100 ? 100 : contextPlugin._origin_w;\n      } else {\n        contextPlugin.inputX.value = contextPlugin._origin_w;\n        contextPlugin.inputY.value = contextPlugin._origin_h;\n      }\n    },\n\n    /**\n     * @description Save the size data (element.setAttribute(\"data-size\"))\n     * Used at the \"setSize\" method\n     * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n     */\n    _module_saveCurrentSize: function (contextPlugin) {\n      const x = this.plugins.resizing._module_getSizeX.call(this, contextPlugin);\n\n      const y = this.plugins.resizing._module_getSizeY.call(this, contextPlugin);\n\n      contextPlugin._element.setAttribute('data-size', x + ',' + y);\n\n      if (!!contextPlugin._videoRatio) contextPlugin._videoRatio = y;\n    },\n\n    /**\n     * @description Call the resizing module\n     * @param {Element} targetElement Resizing target element\n     * @param {string} plugin Plugin name\n     * @returns {Object} Size of resizing div {w, h, t, l}\n     */\n    call_controller_resize: function (targetElement, plugin) {\n      const contextResizing = this.context.resizing;\n      const contextPlugin = this.context[plugin];\n      contextResizing._resize_plugin = plugin;\n      const resizeContainer = contextResizing.resizeContainer;\n      const resizeDiv = contextResizing.resizeDiv;\n      const offset = this.util.getOffset(targetElement, this.context.element.wysiwygFrame);\n      const isVertical = contextResizing._rotateVertical = /^(90|270)$/.test(Math.abs(targetElement.getAttribute('data-rotate')).toString());\n      const w = isVertical ? targetElement.offsetHeight : targetElement.offsetWidth;\n      const h = isVertical ? targetElement.offsetWidth : targetElement.offsetHeight;\n      const t = offset.top;\n      const l = offset.left - this.context.element.wysiwygFrame.scrollLeft;\n      resizeContainer.style.top = t + 'px';\n      resizeContainer.style.left = l + 'px';\n      resizeContainer.style.width = w + 'px';\n      resizeContainer.style.height = h + 'px';\n      resizeDiv.style.top = '0px';\n      resizeDiv.style.left = '0px';\n      resizeDiv.style.width = w + 'px';\n      resizeDiv.style.height = h + 'px';\n      let align = targetElement.getAttribute('data-align') || 'basic';\n      align = align === 'none' ? 'basic' : align; // text\n\n      const container = this.util.getParentElement(targetElement, this.util.isComponent);\n      const cover = this.util.getParentElement(targetElement, 'FIGURE');\n      const displayX = this.plugins.resizing._module_getSizeX.call(this, contextPlugin, targetElement, cover, container) || 'auto';\n      const displayY = contextPlugin._onlyPercentage && plugin === 'image' ? '' : ', ' + (this.plugins.resizing._module_getSizeY.call(this, contextPlugin, targetElement, cover, container) || 'auto');\n      this.util.changeTxt(contextResizing.resizeDisplay, this.lang.dialogBox[align] + ' (' + displayX + displayY + ')'); // resizing display\n\n      contextResizing.resizeButtonGroup.style.display = contextPlugin._resizing ? '' : 'none';\n      const resizeDotShow = contextPlugin._resizing && !contextPlugin._resizeDotHide && !contextPlugin._onlyPercentage ? 'flex' : 'none';\n      const resizeHandles = contextResizing.resizeHandles;\n\n      for (let i = 0, len = resizeHandles.length; i < len; i++) {\n        resizeHandles[i].style.display = resizeDotShow;\n      }\n\n      if (contextPlugin._resizing) {\n        const rotations = contextResizing.rotationButtons;\n        rotations[0].style.display = rotations[1].style.display = contextPlugin._rotation ? '' : 'none';\n      } // align icon\n\n\n      if (contextPlugin._alignHide) {\n        contextResizing.alignButton.style.display = 'none';\n      } else {\n        contextResizing.alignButton.style.display = '';\n        const alignList = contextResizing.alignMenuList;\n        this.util.changeElement(contextResizing.alignButton.firstElementChild, contextResizing.alignIcons[align]);\n\n        for (let i = 0, len = alignList.length; i < len; i++) {\n          if (alignList[i].getAttribute('data-value') === align) this.util.addClass(alignList[i], 'on');else this.util.removeClass(alignList[i], 'on');\n        }\n      } // percentage active\n\n\n      const pButtons = contextResizing.percentageButtons;\n      const value = /%$/.test(targetElement.style.width) && /%$/.test(container.style.width) ? this.util.getNumber(container.style.width, 0) / 100 + '' : '';\n\n      for (let i = 0, len = pButtons.length; i < len; i++) {\n        if (pButtons[i].getAttribute('data-value') === value) {\n          this.util.addClass(pButtons[i], 'active');\n        } else {\n          this.util.removeClass(pButtons[i], 'active');\n        }\n      } // caption display, active\n\n\n      if (!contextPlugin._captionShow) {\n        contextResizing.captionButton.style.display = 'none';\n      } else {\n        contextResizing.captionButton.style.display = '';\n\n        if (this.util.getChildElement(targetElement.parentNode, 'figcaption')) {\n          this.util.addClass(contextResizing.captionButton, 'active');\n          contextPlugin._captionChecked = true;\n        } else {\n          this.util.removeClass(contextResizing.captionButton, 'active');\n          contextPlugin._captionChecked = false;\n        }\n      }\n\n      resizeContainer.style.display = 'block';\n      const addOffset = {\n        left: 0,\n        top: 50\n      };\n\n      if (this.options.iframe) {\n        addOffset.left -= this.context.element.wysiwygFrame.parentElement.offsetLeft;\n        addOffset.top -= this.context.element.wysiwygFrame.parentElement.offsetTop;\n      }\n\n      this.setControllerPosition(contextResizing.resizeButton, resizeContainer, 'bottom', addOffset);\n      this.controllersOn(resizeContainer, contextResizing.resizeButton, this.util.setDisabledButtons.bind(this.util, false, this.resizingDisabledButtons), targetElement, plugin);\n      this.util.setDisabledButtons(true, this.resizingDisabledButtons);\n      contextResizing._resize_w = w;\n      contextResizing._resize_h = h;\n      const originSize = (targetElement.getAttribute('origin-size') || '').split(',');\n      contextResizing._origin_w = originSize[0] || targetElement.naturalWidth;\n      contextResizing._origin_h = originSize[1] || targetElement.naturalHeight;\n      return {\n        w: w,\n        h: h,\n        t: t,\n        l: l\n      };\n    },\n    _closeAlignMenu: null,\n\n    /**\n     * @description Open align submenu of module\n     */\n    openAlignMenu: function () {\n      const alignButton = this.context.resizing.alignButton;\n      this.util.addClass(alignButton, 'on');\n      this.context.resizing.alignMenu.style.top = alignButton.offsetTop + alignButton.offsetHeight + 'px';\n      this.context.resizing.alignMenu.style.left = alignButton.offsetLeft - alignButton.offsetWidth / 2 + 'px';\n      this.context.resizing.alignMenu.style.display = 'block';\n\n      this.plugins.resizing._closeAlignMenu = function () {\n        this.util.removeClass(this.context.resizing.alignButton, 'on');\n        this.context.resizing.alignMenu.style.display = 'none';\n        this.removeDocEvent('click', this.plugins.resizing._closeAlignMenu);\n        this.plugins.resizing._closeAlignMenu = null;\n      }.bind(this);\n\n      this.addDocEvent('click', this.plugins.resizing._closeAlignMenu);\n    },\n\n    /**\n     * @description Click event of resizing toolbar\n     * Performs the action of the clicked toolbar button.\n     * @param {MouseEvent} e Event object\n     */\n    onClick_resizeButton: function (e) {\n      e.stopPropagation();\n      const target = e.target;\n      const command = target.getAttribute('data-command') || target.parentNode.getAttribute('data-command');\n      if (!command) return;\n      const value = target.getAttribute('data-value') || target.parentNode.getAttribute('data-value');\n      const pluginName = this.context.resizing._resize_plugin;\n      const currentContext = this.context[pluginName];\n      const contextEl = currentContext._element;\n      const currentModule = this.plugins[pluginName];\n      e.preventDefault();\n\n      if (typeof this.plugins.resizing._closeAlignMenu === 'function') {\n        this.plugins.resizing._closeAlignMenu();\n\n        if (command === 'onalign') return;\n      }\n\n      switch (command) {\n        case 'auto':\n          this.plugins.resizing.resetTransform.call(this, contextEl);\n          currentModule.setAutoSize.call(this);\n          this.selectComponent(contextEl, pluginName);\n          break;\n\n        case 'percent':\n          let percentY = this.plugins.resizing._module_getSizeY.call(this, currentContext);\n\n          if (this.context.resizing._rotateVertical) {\n            const percentage = contextEl.getAttribute('data-percentage');\n            if (percentage) percentY = percentage.split(',')[1];\n          }\n\n          this.plugins.resizing.resetTransform.call(this, contextEl);\n          currentModule.setPercentSize.call(this, value * 100, this.util.getNumber(percentY, 0) === null || !/%$/.test(percentY) ? '' : percentY);\n          this.selectComponent(contextEl, pluginName);\n          break;\n\n        case 'mirror':\n          const r = contextEl.getAttribute('data-rotate') || '0';\n          let x = contextEl.getAttribute('data-rotateX') || '';\n          let y = contextEl.getAttribute('data-rotateY') || '';\n\n          if (value === 'h' && !this.context.resizing._rotateVertical || value === 'v' && this.context.resizing._rotateVertical) {\n            y = y ? '' : '180';\n          } else {\n            x = x ? '' : '180';\n          }\n\n          contextEl.setAttribute('data-rotateX', x);\n          contextEl.setAttribute('data-rotateY', y);\n\n          this.plugins.resizing._setTransForm(contextEl, r, x, y);\n\n          break;\n\n        case 'rotate':\n          const contextResizing = this.context.resizing;\n          const slope = contextEl.getAttribute('data-rotate') * 1 + value * 1;\n          const deg = this._w.Math.abs(slope) >= 360 ? 0 : slope;\n          contextEl.setAttribute('data-rotate', deg);\n          contextResizing._rotateVertical = /^(90|270)$/.test(this._w.Math.abs(deg).toString());\n          this.plugins.resizing.setTransformSize.call(this, contextEl, null, null);\n          this.selectComponent(contextEl, pluginName);\n          break;\n\n        case 'onalign':\n          this.plugins.resizing.openAlignMenu.call(this);\n          return;\n\n        case 'align':\n          const alignValue = value === 'basic' ? 'none' : value;\n          currentModule.setAlign.call(this, alignValue, null, null, null);\n          this.selectComponent(contextEl, pluginName);\n          break;\n\n        case 'caption':\n          const caption = !currentContext._captionChecked;\n          currentModule.openModify.call(this, true);\n          currentContext._captionChecked = currentContext.captionCheckEl.checked = caption;\n          currentModule.update_image.call(this, false, false, false);\n\n          if (caption) {\n            const captionText = this.util.getChildElement(currentContext._caption, function (current) {\n              return current.nodeType === 3;\n            });\n\n            if (!captionText) {\n              currentContext._caption.focus();\n            } else {\n              this.setRange(captionText, 0, captionText, captionText.textContent.length);\n            }\n\n            this.controllersOff();\n          } else {\n            this.selectComponent(contextEl, pluginName);\n            currentModule.openModify.call(this, true);\n          }\n\n          break;\n\n        case 'revert':\n          currentModule.setOriginSize.call(this);\n          this.selectComponent(contextEl, pluginName);\n          break;\n\n        case 'update':\n          currentModule.openModify.call(this);\n          this.controllersOff();\n          break;\n\n        case 'delete':\n          currentModule.destroy.call(this);\n          break;\n      } // history stack\n\n\n      this.history.push(false);\n    },\n\n    /**\n     * @description Initialize the transform style (rotation) of the element.\n     * @param {Element} element Target element\n     */\n    resetTransform: function (element) {\n      const size = (element.getAttribute('data-size') || element.getAttribute('data-origin') || '').split(',');\n      this.context.resizing._rotateVertical = false;\n      element.style.maxWidth = '';\n      element.style.transform = '';\n      element.style.transformOrigin = '';\n      element.setAttribute('data-rotate', '');\n      element.setAttribute('data-rotateX', '');\n      element.setAttribute('data-rotateY', '');\n\n      this.plugins[this.context.resizing._resize_plugin].setSize.call(this, size[0] ? size[0] : 'auto', size[1] ? size[1] : '', true);\n    },\n\n    /**\n     * @description Set the transform style (rotation) of the element.\n     * @param {Element} element Target element\n     * @param {Number|null} width Element's width size\n     * @param {Number|null} height Element's height size\n     */\n    setTransformSize: function (element, width, height) {\n      let percentage = element.getAttribute('data-percentage');\n      const isVertical = this.context.resizing._rotateVertical;\n      const deg = element.getAttribute('data-rotate') * 1;\n      let transOrigin = '';\n\n      if (percentage && !isVertical) {\n        percentage = percentage.split(',');\n\n        if (percentage[0] === 'auto' && percentage[1] === 'auto') {\n          this.plugins[this.context.resizing._resize_plugin].setAutoSize.call(this);\n        } else {\n          this.plugins[this.context.resizing._resize_plugin].setPercentSize.call(this, percentage[0], percentage[1]);\n        }\n      } else {\n        const cover = this.util.getParentElement(element, 'FIGURE');\n        const offsetW = width || element.offsetWidth;\n        const offsetH = height || element.offsetHeight;\n        const w = (isVertical ? offsetH : offsetW) + 'px';\n        const h = (isVertical ? offsetW : offsetH) + 'px';\n\n        this.plugins[this.context.resizing._resize_plugin].cancelPercentAttr.call(this);\n\n        this.plugins[this.context.resizing._resize_plugin].setSize.call(this, offsetW + 'px', offsetH + 'px', true);\n\n        cover.style.width = w;\n        cover.style.height = !!this.context[this.context.resizing._resize_plugin]._caption ? '' : h;\n\n        if (isVertical) {\n          let transW = offsetW / 2 + 'px ' + offsetW / 2 + 'px 0';\n          let transH = offsetH / 2 + 'px ' + offsetH / 2 + 'px 0';\n          transOrigin = deg === 90 || deg === -270 ? transH : transW;\n        }\n      }\n\n      element.style.transformOrigin = transOrigin;\n\n      this.plugins.resizing._setTransForm(element, deg.toString(), element.getAttribute('data-rotateX') || '', element.getAttribute('data-rotateY') || '');\n\n      if (isVertical) element.style.maxWidth = 'none';else element.style.maxWidth = '';\n      this.plugins.resizing.setCaptionPosition.call(this, element);\n    },\n    _setTransForm: function (element, r, x, y) {\n      let width = (element.offsetWidth - element.offsetHeight) * (/-/.test(r) ? 1 : -1);\n      let translate = '';\n\n      if (/[1-9]/.test(r) && (x || y)) {\n        translate = x ? 'Y' : 'X';\n\n        switch (r) {\n          case '90':\n            translate = x && y ? 'X' : y ? translate : '';\n            break;\n\n          case '270':\n            width *= -1;\n            translate = x && y ? 'Y' : x ? translate : '';\n            break;\n\n          case '-90':\n            translate = x && y ? 'Y' : x ? translate : '';\n            break;\n\n          case '-270':\n            width *= -1;\n            translate = x && y ? 'X' : y ? translate : '';\n            break;\n\n          default:\n            translate = '';\n        }\n      }\n\n      if (r % 180 === 0) {\n        element.style.maxWidth = '';\n      }\n\n      element.style.transform = 'rotate(' + r + 'deg)' + (x ? ' rotateX(' + x + 'deg)' : '') + (y ? ' rotateY(' + y + 'deg)' : '') + (translate ? ' translate' + translate + '(' + width + 'px)' : '');\n    },\n\n    /**\n     * @description The position of the caption is set automatically.\n     * @param {Element} element Target element (not caption element)\n     */\n    setCaptionPosition: function (element) {\n      const figcaption = this.util.getChildElement(this.util.getParentElement(element, 'FIGURE'), 'FIGCAPTION');\n\n      if (figcaption) {\n        figcaption.style.marginTop = (this.context.resizing._rotateVertical ? element.offsetWidth - element.offsetHeight : 0) + 'px';\n      }\n    },\n\n    /**\n     * @description Mouse down event of resize handles\n     * @param {MouseEvent} e Event object \n     */\n    onMouseDown_resize_handle: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n      const contextResizing = this.context.resizing;\n      const direction = contextResizing._resize_direction = e.target.classList[0];\n      contextResizing._resizeClientX = e.clientX;\n      contextResizing._resizeClientY = e.clientY;\n      this.context.element.resizeBackground.style.display = 'block';\n      contextResizing.resizeButton.style.display = 'none';\n      contextResizing.resizeDiv.style.float = /l/.test(direction) ? 'right' : /r/.test(direction) ? 'left' : 'none';\n\n      const closureFunc_bind = function closureFunc(e) {\n        if (e.type === 'keydown' && e.keyCode !== 27) return;\n        const change = contextResizing._isChange;\n        contextResizing._isChange = false;\n        this.removeDocEvent('mousemove', resizing_element_bind);\n        this.removeDocEvent('mouseup', closureFunc_bind);\n        this.removeDocEvent('keydown', closureFunc_bind);\n\n        if (e.type === 'keydown') {\n          this.controllersOff();\n          this.context.element.resizeBackground.style.display = 'none';\n\n          this.plugins[this.context.resizing._resize_plugin].init.call(this);\n        } else {\n          // element resize\n          this.plugins.resizing.cancel_controller_resize.call(this, direction); // history stack\n\n          if (change) this.history.push(false);\n        }\n      }.bind(this);\n\n      const resizing_element_bind = this.plugins.resizing.resizing_element.bind(this, contextResizing, direction, this.context[contextResizing._resize_plugin]);\n      this.addDocEvent('mousemove', resizing_element_bind);\n      this.addDocEvent('mouseup', closureFunc_bind);\n      this.addDocEvent('keydown', closureFunc_bind);\n    },\n\n    /**\n     * @description Mouse move event after call \"onMouseDown_resize_handle\" of resize handles\n     * The size of the module's \"div\" is adjusted according to the mouse move event.\n     * @param {Object} contextResizing \"core.context.resizing\" object (binding argument)\n     * @param {String} direction Direction (\"tl\", \"tr\", \"bl\", \"br\", \"lw\", \"th\", \"rw\", \"bh\") (binding argument)\n     * @param {Object} plugin \"core.context[currentPlugin]\" object (binding argument)\n     * @param {MouseEvent} e Event object\n     */\n    resizing_element: function (contextResizing, direction, plugin, e) {\n      const clientX = e.clientX;\n      const clientY = e.clientY;\n      let resultW = plugin._element_w;\n      let resultH = plugin._element_h;\n      const w = plugin._element_w + (/r/.test(direction) ? clientX - contextResizing._resizeClientX : contextResizing._resizeClientX - clientX);\n      const h = plugin._element_h + (/b/.test(direction) ? clientY - contextResizing._resizeClientY : contextResizing._resizeClientY - clientY);\n      const wh = plugin._element_h / plugin._element_w * w;\n      if (/t/.test(direction)) contextResizing.resizeDiv.style.top = plugin._element_h - (/h/.test(direction) ? h : wh) + 'px';\n      if (/l/.test(direction)) contextResizing.resizeDiv.style.left = plugin._element_w - w + 'px';\n\n      if (/r|l/.test(direction)) {\n        contextResizing.resizeDiv.style.width = w + 'px';\n        resultW = w;\n      }\n\n      if (/^(t|b)[^h]$/.test(direction)) {\n        contextResizing.resizeDiv.style.height = wh + 'px';\n        resultH = wh;\n      } else if (/^(t|b)h$/.test(direction)) {\n        contextResizing.resizeDiv.style.height = h + 'px';\n        resultH = h;\n      }\n\n      contextResizing._resize_w = resultW;\n      contextResizing._resize_h = resultH;\n      this.util.changeTxt(contextResizing.resizeDisplay, this._w.Math.round(resultW) + ' x ' + this._w.Math.round(resultH));\n      contextResizing._isChange = true;\n    },\n\n    /**\n     * @description Resize the element to the size of the \"div\" adjusted in the \"resizing_element\" method.\n     * Called at the mouse-up event registered in \"onMouseDown_resize_handle\".\n     * @param {String} direction Direction (\"tl\", \"tr\", \"bl\", \"br\", \"lw\", \"th\", \"rw\", \"bh\")\n     */\n    cancel_controller_resize: function (direction) {\n      const isVertical = this.context.resizing._rotateVertical;\n      this.controllersOff();\n      this.context.element.resizeBackground.style.display = 'none';\n\n      let w = this._w.Math.round(isVertical ? this.context.resizing._resize_h : this.context.resizing._resize_w);\n\n      let h = this._w.Math.round(isVertical ? this.context.resizing._resize_w : this.context.resizing._resize_h);\n\n      if (!isVertical && !/%$/.test(w)) {\n        const padding = 16;\n        const limit = this.context.element.wysiwygFrame.clientWidth - padding * 2 - 2;\n\n        if (this.util.getNumber(w, 0) > limit) {\n          h = this._w.Math.round(h / w * limit);\n          w = limit;\n        }\n      }\n\n      const pluginName = this.context.resizing._resize_plugin;\n      this.plugins[pluginName].setSize.call(this, w, h, false, direction);\n      if (isVertical) this.plugins.resizing.setTransformSize.call(this, this.context[this.context.resizing._resize_plugin]._element, w, h);\n      this.selectComponent(this.context[pluginName]._element, pluginName);\n    }\n  };\n\n  if (typeof noGlobal === typeof undefined) {\n    if (!window.SUNEDITOR_MODULES) {\n      Object.defineProperty(window, 'SUNEDITOR_MODULES', {\n        enumerable: true,\n        writable: false,\n        configurable: false,\n        value: {}\n      });\n    }\n\n    Object.defineProperty(window.SUNEDITOR_MODULES, 'resizing', {\n      enumerable: true,\n      writable: false,\n      configurable: false,\n      value: resizing\n    });\n  }\n\n  return resizing;\n});","map":{"version":3,"sources":["C:/Users/Digel/Desktop/repos/RCFD-Website-with-React/node_modules/suneditor/src/plugins/modules/resizing.js"],"names":["global","factory","module","exports","document","w","Error","window","noGlobal","resizing","name","add","core","icons","context","_resizeClientX","_resizeClientY","_resize_plugin","_resize_w","_resize_h","_origin_w","_origin_h","_rotateVertical","_resize_direction","_move_path","_isChange","alignIcons","basic","align_justify","left","align_left","right","align_right","center","align_center","resize_div_container","setController_resize","resizeContainer","resizeDiv","querySelector","resizeDot","resizeDisplay","resize_button","setController_button","resizeButton","resize_handles","resizeHandles","querySelectorAll","resizeButtonGroup","rotationButtons","percentageButtons","alignMenu","alignMenuList","alignButton","autoSizeButton","captionButton","addEventListener","e","preventDefault","onMouseDown_resize_handle","bind","onClick_resizeButton","element","relative","appendChild","resize_container","util","createElement","className","style","display","innerHTML","lang","controller","resize100","resize75","resize50","auto_size","autoSize","rotate_left","rotateLeft","rotate_right","rotateRight","mirror_horizontal","mirrorHorizontal","mirror_vertical","mirrorVertical","toolbar","align","dialogBox","caption","revert","revertButton","modify","edit","delete","remove","_module_getSizeX","contextPlugin","cover","container","_element","_cover","_container","test","width","getNumber","_module_getSizeY","height","paddingBottom","_module_setModifyInputSize","pluginObj","percentageRotation","_onlyPercentage","proportion","checked","_proportionChecked","getAttribute","x","plugins","call","_defaultSizeX","inputX","value","setInputSize","y","_defaultSizeY","inputY","disabled","setRatio","_module_setInputSize","xy","_ratio","xUnit","replace","sizeUnit","yUnit","dec","_ratioY","_ratioX","_module_setRatio","xValue","yValue","_module_sizeRevert","_module_saveCurrentSize","setAttribute","_videoRatio","call_controller_resize","targetElement","plugin","contextResizing","offset","getOffset","wysiwygFrame","isVertical","Math","abs","toString","offsetHeight","offsetWidth","h","t","top","l","scrollLeft","getParentElement","isComponent","displayX","displayY","changeTxt","_resizing","resizeDotShow","_resizeDotHide","i","len","length","rotations","_rotation","_alignHide","alignList","changeElement","firstElementChild","addClass","removeClass","pButtons","_captionShow","getChildElement","parentNode","_captionChecked","addOffset","options","iframe","parentElement","offsetLeft","offsetTop","setControllerPosition","controllersOn","setDisabledButtons","resizingDisabledButtons","originSize","split","naturalWidth","naturalHeight","_closeAlignMenu","openAlignMenu","removeDocEvent","addDocEvent","stopPropagation","target","command","pluginName","currentContext","contextEl","currentModule","resetTransform","setAutoSize","selectComponent","percentY","percentage","setPercentSize","r","_setTransForm","slope","deg","_w","setTransformSize","alignValue","setAlign","openModify","captionCheckEl","update_image","captionText","_caption","current","nodeType","focus","setRange","textContent","controllersOff","setOriginSize","destroy","history","push","size","maxWidth","transform","transformOrigin","setSize","transOrigin","offsetW","offsetH","cancelPercentAttr","transW","transH","setCaptionPosition","translate","figcaption","marginTop","direction","classList","clientX","clientY","resizeBackground","float","closureFunc_bind","closureFunc","type","keyCode","change","resizing_element_bind","init","cancel_controller_resize","resizing_element","resultW","_element_w","resultH","_element_h","wh","round","padding","limit","clientWidth","undefined","SUNEDITOR_MODULES","Object","defineProperty","enumerable","writable","configurable"],"mappings":"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","sourcesContent":["/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\n(function (global, factory) {\n    if (typeof module === 'object' && typeof module.exports === 'object') {\n        module.exports = global.document ?\n            factory(global, true) :\n            function (w) {\n                if (!w.document) {\n                    throw new Error('SUNEDITOR_MODULES a window with a document');\n                }\n                return factory(w);\n            };\n    } else {\n        factory(global);\n    }\n}(typeof window !== 'undefined' ? window : this, function (window, noGlobal) {\n    const resizing = {\n        name: 'resizing',\n        /**\n         * @description Constructor\n         * Require context properties when resizing module\n            inputX: Element,\n            inputY: Element,\n            _container: null,\n            _cover: null,\n            _element: null,\n            _element_w: 1,\n            _element_h: 1,\n            _element_l: 0,\n            _element_t: 0,\n            _defaultSizeX: 'auto',\n            _defaultSizeY: 'auto',\n            _origin_w: core.options.imageWidth === 'auto' ? '' : core.options.imageWidth,\n            _origin_h: core.options.imageHeight === 'auto' ? '' : core.options.imageHeight,\n            _proportionChecked: true,\n            // -- select function --\n            _resizing: core.options.imageResizing,\n            _resizeDotHide: !core.options.imageHeightShow,\n            _rotation: core.options.imageRotation,\n            _onlyPercentage: core.options.imageSizeOnlyPercentage,\n            _ratio: false,\n            _ratioX: 1,\n            _ratioY: 1\n            _captionShow: true,\n            // -- when used caption (_captionShow: true) --\n            _caption: null,\n            _captionChecked: false,\n            captionCheckEl: null,\n         * @param {Object} core Core object \n         */\n        add: function (core) {\n            const icons = core.icons;\n            const context = core.context;\n            context.resizing = {\n                _resizeClientX: 0,\n                _resizeClientY: 0,\n                _resize_plugin: '',\n                _resize_w: 0,\n                _resize_h: 0,\n                _origin_w: 0,\n                _origin_h: 0,\n                _rotateVertical: false,\n                _resize_direction: '',\n                _move_path: null,\n                _isChange: false,\n                alignIcons: {\n                    basic: icons.align_justify,\n                    left: icons.align_left,\n                    right: icons.align_right,\n                    center: icons.align_center\n                }\n            };\n    \n            /** resize controller, button */\n            let resize_div_container = this.setController_resize(core);\n            context.resizing.resizeContainer = resize_div_container;\n    \n            context.resizing.resizeDiv = resize_div_container.querySelector('.se-modal-resize');\n            context.resizing.resizeDot = resize_div_container.querySelector('.se-resize-dot');\n            context.resizing.resizeDisplay = resize_div_container.querySelector('.se-resize-display');\n    \n            let resize_button = this.setController_button(core);\n            context.resizing.resizeButton = resize_button;\n    \n            let resize_handles = context.resizing.resizeHandles = context.resizing.resizeDot.querySelectorAll('span');\n            context.resizing.resizeButtonGroup = resize_button.querySelector('._se_resizing_btn_group');\n            context.resizing.rotationButtons = resize_button.querySelectorAll('._se_resizing_btn_group ._se_rotation');\n            context.resizing.percentageButtons = resize_button.querySelectorAll('._se_resizing_btn_group ._se_percentage');\n    \n            context.resizing.alignMenu = resize_button.querySelector('.se-resizing-align-list');\n            context.resizing.alignMenuList = context.resizing.alignMenu.querySelectorAll('button');\n    \n            context.resizing.alignButton = resize_button.querySelector('._se_resizing_align_button');\n            context.resizing.autoSizeButton = resize_button.querySelector('._se_resizing_btn_group ._se_auto_size');\n            context.resizing.captionButton = resize_button.querySelector('._se_resizing_caption_button');\n    \n            /** add event listeners */\n            resize_div_container.addEventListener('mousedown', function (e) { e.preventDefault(); });\n            resize_handles[0].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[1].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[2].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[3].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[4].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[5].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[6].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_handles[7].addEventListener('mousedown', this.onMouseDown_resize_handle.bind(core));\n            resize_button.addEventListener('click', this.onClick_resizeButton.bind(core));\n    \n            /** append html */\n            context.element.relative.appendChild(resize_div_container);\n            context.element.relative.appendChild(resize_button);\n    \n            /** empty memory */\n            resize_div_container = null, resize_button = null, resize_handles = null;\n        },\n    \n        /** resize controller, button (image, iframe, video) */\n        setController_resize: function (core) {\n            const resize_container = core.util.createElement('DIV');\n            \n            resize_container.className = 'se-controller se-resizing-container';\n            resize_container.style.display = 'none';\n            resize_container.innerHTML = '' +\n                '<div class=\"se-modal-resize\"></div>' +\n                '<div class=\"se-resize-dot\">' +\n                    '<span class=\"tl\"></span>' +\n                    '<span class=\"tr\"></span>' +\n                    '<span class=\"bl\"></span>' +\n                    '<span class=\"br\"></span>' +\n                    '<span class=\"lw\"></span>' +\n                    '<span class=\"th\"></span>' +\n                    '<span class=\"rw\"></span>' +\n                    '<span class=\"bh\"></span>' +\n                    '<div class=\"se-resize-display\"></div>' +\n                '</div>';\n    \n            return resize_container;\n        },\n    \n        setController_button: function (core) {\n            const lang = core.lang;\n            const icons = core.icons;\n            const resize_button = core.util.createElement(\"DIV\");\n    \n            resize_button.className = \"se-controller se-controller-resizing\";\n            resize_button.innerHTML = '' +\n                '<div class=\"se-arrow se-arrow-up\"></div>' +\n                '<div class=\"se-btn-group _se_resizing_btn_group\">' +\n                    '<button type=\"button\" data-command=\"percent\" data-value=\"1\" class=\"se-tooltip _se_percentage\">' +\n                        '<span>100%</span>' +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.resize100 + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"percent\" data-value=\"0.75\" class=\"se-tooltip _se_percentage\">' +\n                        '<span>75%</span>' +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.resize75 + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"percent\" data-value=\"0.5\" class=\"se-tooltip _se_percentage\">' +\n                        '<span>50%</span>' +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.resize50 + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"auto\" class=\"se-btn se-tooltip _se_auto_size\">' +\n                        icons.auto_size +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.autoSize + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"rotate\" data-value=\"-90\" class=\"se-btn se-tooltip _se_rotation\">' +\n                        icons.rotate_left +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.rotateLeft + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"rotate\" data-value=\"90\" class=\"se-btn se-tooltip _se_rotation\">' +\n                        icons.rotate_right +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.rotateRight + '</span></span>' +\n                    '</button>' +\n                '</div>' +\n                '<div class=\"se-btn-group\" style=\"padding-top: 0;\">' +\n                    '<button type=\"button\" data-command=\"mirror\" data-value=\"h\" class=\"se-btn se-tooltip\">' +\n                        icons.mirror_horizontal +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.mirrorHorizontal + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"mirror\" data-value=\"v\" class=\"se-btn se-tooltip\">' +\n                        icons.mirror_vertical +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.mirrorVertical + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"onalign\" class=\"se-btn se-tooltip _se_resizing_align_button\">' +\n                        icons.align_justify +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.toolbar.align + '</span></span>' +\n                    '</button>' +\n                    '<div class=\"se-btn-group-sub sun-editor-common se-list-layer se-resizing-align-list\">' +\n                        '<div class=\"se-list-inner\">' +\n                            '<ul class=\"se-list-basic\">' +\n                                '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"basic\">' +\n                                    icons.align_justify +\n                                    '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.basic + '</span></span>' +\n                                '</button></li>' +\n                                '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"left\">' +\n                                    icons.align_left +\n                                    '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.left + '</span></span>' +\n                                '</button></li>' +\n                                '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"center\">' +\n                                    icons.align_center +\n                                    '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.center + '</span></span>' +\n                                '</button></li>' +\n                                '<li><button type=\"button\" class=\"se-btn-list se-tooltip\" data-command=\"align\" data-value=\"right\">' +\n                                    icons.align_right +\n                                    '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.right + '</span></span>' +\n                                '</button></li>' +\n                            '</ul>' +\n                        '</div>' +\n                    '</div>' +\n                    '<button type=\"button\" data-command=\"caption\" class=\"se-btn se-tooltip _se_resizing_caption_button\">' +\n                        icons.caption +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.caption + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"revert\" class=\"se-btn se-tooltip\">' +\n                        icons.revert +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.dialogBox.revertButton + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"update\" class=\"se-btn se-tooltip\">' +\n                        icons.modify +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.edit + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"delete\" class=\"se-btn se-tooltip\">' +\n                        icons.delete +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.remove + '</span></span>' +\n                    '</button>' +\n                '</div>';\n    \n            return resize_button;\n        },\n    \n        /**\n         * @description Gets the width size\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         * @param {Element} element Target element\n         * @param {Element} cover Cover element (FIGURE)\n         * @param {Element} container Container element (DIV.se-component)\n         * @returns {String}\n         */\n        _module_getSizeX: function (contextPlugin, element, cover, container) {\n            if (!element) element = contextPlugin._element;\n            if (!cover) cover = contextPlugin._cover;\n            if (!container) container = contextPlugin._container;\n    \n            if (!element) return '';\n    \n            return !/%$/.test(element.style.width) ? element.style.width : ((container && this.util.getNumber(container.style.width, 2)) || 100) + '%';\n        },\n    \n        /**\n         * @description Gets the height size\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         * @param {Element} element Target element\n         * @param {Element} cover Cover element (FIGURE)\n         * @param {Element} container Container element (DIV.se-component)\n         * @returns {String}\n         */\n        _module_getSizeY: function (contextPlugin, element, cover, container) {\n            if (!element) element = contextPlugin._element;\n            if (!cover) cover = contextPlugin._cover;\n            if (!container) container = contextPlugin._container;\n    \n            if (!container || !cover) return (element && element.style.height) || '';\n    \n            return this.util.getNumber(cover.style.paddingBottom, 0) > 0 && !this.context.resizing._rotateVertical ? cover.style.height : (!/%$/.test(element.style.height) || !/%$/.test(element.style.width) ? element.style.height : ((container && this.util.getNumber(container.style.height, 2)) || 100) + '%');\n        },\n\n        /**\n         * @description Called at the \"openModify\" to put the size of the current target into the size input element.\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         * @param {Object} pluginObj Plugin object\n         */\n        _module_setModifyInputSize: function (contextPlugin, pluginObj) {\n            const percentageRotation = contextPlugin._onlyPercentage && this.context.resizing._rotateVertical;\n            contextPlugin.proportion.checked = contextPlugin._proportionChecked = contextPlugin._element.getAttribute('data-proportion') !== 'false';\n    \n            let x = percentageRotation ? '' : this.plugins.resizing._module_getSizeX.call(this, contextPlugin);\n            if (x === contextPlugin._defaultSizeX) x = '';\n            if (contextPlugin._onlyPercentage) x = this.util.getNumber(x, 2);\n            contextPlugin.inputX.value = x;\n            pluginObj.setInputSize.call(this, 'x');\n            \n            if (!contextPlugin._onlyPercentage) {\n                let y = percentageRotation ? '' : this.plugins.resizing._module_getSizeY.call(this, contextPlugin);\n                if (y === contextPlugin._defaultSizeY) y = '';\n                if (contextPlugin._onlyPercentage) y = this.util.getNumber(y, 2);\n                contextPlugin.inputY.value = y;\n            }\n            \n            contextPlugin.inputX.disabled = percentageRotation ? true : false;\n            contextPlugin.inputY.disabled = percentageRotation ? true : false;\n            contextPlugin.proportion.disabled = percentageRotation ? true : false;\n    \n            pluginObj.setRatio.call(this);\n        },\n    \n        /**\n         * @description It is called in \"setInputSize\" (input tag keyupEvent), \n         * checks the value entered in the input tag, \n         * calculates the ratio, and sets the calculated value in the input tag of the opposite size.\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         * @param {String} xy 'x': width, 'y': height\n         */\n        _module_setInputSize: function (contextPlugin, xy) {\n            if (contextPlugin._onlyPercentage) {\n                if (xy === 'x' && contextPlugin.inputX.value > 100) contextPlugin.inputX.value = 100;\n                return;\n            }\n    \n            if (contextPlugin.proportion.checked && contextPlugin._ratio && /\\d/.test(contextPlugin.inputX.value) && /\\d/.test(contextPlugin.inputY.value)) {\n                const xUnit = contextPlugin.inputX.value.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n                const yUnit = contextPlugin.inputY.value.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n    \n                if (xUnit !== yUnit) return;\n    \n                const dec = xUnit === '%' ? 2 : 0;\n    \n                if (xy === 'x') {\n                    contextPlugin.inputY.value = this.util.getNumber(contextPlugin._ratioY * this.util.getNumber(contextPlugin.inputX.value, dec), dec) + yUnit;\n                } else {\n                    contextPlugin.inputX.value = this.util.getNumber(contextPlugin._ratioX * this.util.getNumber(contextPlugin.inputY.value, dec), dec) + xUnit;\n                }\n            }\n        },\n    \n        /**\n         * @description It is called in \"setRatio\" (input and proportionCheck tags changeEvent), \n         * checks the value of the input tag, calculates the ratio, and resets it in the input tag.\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         */\n        _module_setRatio: function (contextPlugin) {\n            const xValue = contextPlugin.inputX.value;\n            const yValue = contextPlugin.inputY.value;\n    \n            if (contextPlugin.proportion.checked && /\\d+/.test(xValue) && /\\d+/.test(yValue)) {\n                const xUnit = xValue.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n                const yUnit = yValue.replace(/\\d+|\\./g, '') || contextPlugin.sizeUnit;\n    \n                if (xUnit !== yUnit) {\n                    contextPlugin._ratio = false;\n                } else if (!contextPlugin._ratio) {\n                    const x = this.util.getNumber(xValue, 0);\n                    const y = this.util.getNumber(yValue, 0);\n    \n                    contextPlugin._ratio = true;\n                    contextPlugin._ratioX = x / y;\n                    contextPlugin._ratioY = y / x;\n                }\n            } else {\n                contextPlugin._ratio = false;\n            }\n        },\n    \n        /**\n         * @description Revert size of element to origin size (plugin._origin_w, plugin._origin_h)\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         */\n        _module_sizeRevert: function (contextPlugin) {\n            if (contextPlugin._onlyPercentage) {\n                contextPlugin.inputX.value = contextPlugin._origin_w > 100 ? 100 : contextPlugin._origin_w;\n            } else {\n                contextPlugin.inputX.value = contextPlugin._origin_w;\n                contextPlugin.inputY.value = contextPlugin._origin_h;\n            }\n        },\n    \n        /**\n         * @description Save the size data (element.setAttribute(\"data-size\"))\n         * Used at the \"setSize\" method\n         * @param {Object} contextPlugin context object of plugin (core.context[plugin])\n         */\n        _module_saveCurrentSize: function (contextPlugin) {\n            const x = this.plugins.resizing._module_getSizeX.call(this, contextPlugin);\n            const y = this.plugins.resizing._module_getSizeY.call(this, contextPlugin);\n            contextPlugin._element.setAttribute('data-size', x + ',' + y);\n            if (!!contextPlugin._videoRatio) contextPlugin._videoRatio = y;\n        },\n    \n        /**\n         * @description Call the resizing module\n         * @param {Element} targetElement Resizing target element\n         * @param {string} plugin Plugin name\n         * @returns {Object} Size of resizing div {w, h, t, l}\n         */\n        call_controller_resize: function (targetElement, plugin) {\n            const contextResizing = this.context.resizing;\n            const contextPlugin = this.context[plugin];\n            contextResizing._resize_plugin = plugin;\n    \n            const resizeContainer = contextResizing.resizeContainer;\n            const resizeDiv = contextResizing.resizeDiv;\n            const offset = this.util.getOffset(targetElement, this.context.element.wysiwygFrame);\n    \n            const isVertical = contextResizing._rotateVertical = /^(90|270)$/.test(Math.abs(targetElement.getAttribute('data-rotate')).toString());\n    \n            const w = isVertical ? targetElement.offsetHeight : targetElement.offsetWidth;\n            const h = isVertical ? targetElement.offsetWidth : targetElement.offsetHeight;\n            const t = offset.top;\n            const l = offset.left - this.context.element.wysiwygFrame.scrollLeft;\n    \n            resizeContainer.style.top = t + 'px';\n            resizeContainer.style.left = l + 'px';\n            resizeContainer.style.width = w + 'px';\n            resizeContainer.style.height = h + 'px';\n    \n            resizeDiv.style.top = '0px';\n            resizeDiv.style.left = '0px';\n            resizeDiv.style.width =  w + 'px';\n            resizeDiv.style.height =  h + 'px';\n    \n            let align = targetElement.getAttribute('data-align') || 'basic';\n            align = align === 'none' ? 'basic' : align;\n    \n            // text\n            const container = this.util.getParentElement(targetElement, this.util.isComponent);\n            const cover = this.util.getParentElement(targetElement, 'FIGURE');\n            const displayX = this.plugins.resizing._module_getSizeX.call(this, contextPlugin, targetElement, cover, container) || 'auto';\n            const displayY = contextPlugin._onlyPercentage && plugin === 'image' ? '' : ', ' + (this.plugins.resizing._module_getSizeY.call(this, contextPlugin, targetElement, cover, container) || 'auto');\n            this.util.changeTxt(contextResizing.resizeDisplay, this.lang.dialogBox[align] + ' (' + displayX + displayY + ')');\n    \n            // resizing display\n            contextResizing.resizeButtonGroup.style.display = contextPlugin._resizing ? '' : 'none';\n            const resizeDotShow = contextPlugin._resizing && !contextPlugin._resizeDotHide && !contextPlugin._onlyPercentage ? 'flex' : 'none';\n            const resizeHandles = contextResizing.resizeHandles;\n            for (let i = 0, len = resizeHandles.length; i < len; i++) {\n                resizeHandles[i].style.display = resizeDotShow;\n            }\n    \n            if (contextPlugin._resizing) {\n                const rotations = contextResizing.rotationButtons;\n                rotations[0].style.display = rotations[1].style.display = contextPlugin._rotation ? '' : 'none';\n            }\n    \n            // align icon\n            if (contextPlugin._alignHide) {\n                contextResizing.alignButton.style.display = 'none';\n            } else {\n                contextResizing.alignButton.style.display = '';\n                const alignList = contextResizing.alignMenuList;\n                this.util.changeElement(contextResizing.alignButton.firstElementChild, contextResizing.alignIcons[align]);\n                for (let i = 0, len = alignList.length; i < len; i++) {\n                    if (alignList[i].getAttribute('data-value') === align) this.util.addClass(alignList[i], 'on');\n                    else this.util.removeClass(alignList[i], 'on');\n                }\n            }\n    \n            // percentage active\n            const pButtons = contextResizing.percentageButtons;\n            const value = /%$/.test(targetElement.style.width) && /%$/.test(container.style.width) ? (this.util.getNumber(container.style.width, 0) / 100) + '' : '' ;\n            for (let i = 0, len = pButtons.length; i < len; i++) {\n                if (pButtons[i].getAttribute('data-value') === value) {\n                    this.util.addClass(pButtons[i], 'active');\n                } else {\n                    this.util.removeClass(pButtons[i], 'active');\n                }\n            }\n    \n            // caption display, active\n            if (!contextPlugin._captionShow) {\n                contextResizing.captionButton.style.display = 'none';\n            } else {\n                contextResizing.captionButton.style.display = '';\n                if (this.util.getChildElement(targetElement.parentNode, 'figcaption')) {\n                    this.util.addClass(contextResizing.captionButton, 'active');\n                    contextPlugin._captionChecked = true;\n                } else {\n                    this.util.removeClass(contextResizing.captionButton, 'active');\n                    contextPlugin._captionChecked = false;\n                }\n            }\n\n            resizeContainer.style.display = 'block';\n\n            const addOffset = {left: 0, top: 50};\n            if (this.options.iframe) {\n                addOffset.left -= this.context.element.wysiwygFrame.parentElement.offsetLeft;\n                addOffset.top -= this.context.element.wysiwygFrame.parentElement.offsetTop;\n            }\n\n            this.setControllerPosition(contextResizing.resizeButton, resizeContainer, 'bottom', addOffset);\n            this.controllersOn(resizeContainer, contextResizing.resizeButton, this.util.setDisabledButtons.bind(this.util, false, this.resizingDisabledButtons), targetElement, plugin);\n            this.util.setDisabledButtons(true, this.resizingDisabledButtons);\n    \n            contextResizing._resize_w = w;\n            contextResizing._resize_h = h;\n    \n            const originSize = (targetElement.getAttribute('origin-size') || '').split(',');\n            contextResizing._origin_w = originSize[0] || targetElement.naturalWidth;\n            contextResizing._origin_h = originSize[1] || targetElement.naturalHeight;\n    \n            return {\n                w: w,\n                h: h,\n                t: t,\n                l: l\n            };\n        },\n    \n        _closeAlignMenu: null,\n\n        /**\n         * @description Open align submenu of module\n         */\n        openAlignMenu: function () {\n            const alignButton = this.context.resizing.alignButton;\n            this.util.addClass(alignButton, 'on');\n            this.context.resizing.alignMenu.style.top = (alignButton.offsetTop + alignButton.offsetHeight) + 'px';\n            this.context.resizing.alignMenu.style.left = (alignButton.offsetLeft - alignButton.offsetWidth / 2) + 'px';\n            this.context.resizing.alignMenu.style.display = 'block';\n    \n            this.plugins.resizing._closeAlignMenu = function () {\n                this.util.removeClass(this.context.resizing.alignButton, 'on');\n                this.context.resizing.alignMenu.style.display = 'none';\n                this.removeDocEvent('click', this.plugins.resizing._closeAlignMenu);\n                this.plugins.resizing._closeAlignMenu = null;\n            }.bind(this);\n    \n            this.addDocEvent('click', this.plugins.resizing._closeAlignMenu);\n        },\n    \n        /**\n         * @description Click event of resizing toolbar\n         * Performs the action of the clicked toolbar button.\n         * @param {MouseEvent} e Event object\n         */\n        onClick_resizeButton: function (e) {\n            e.stopPropagation();\n    \n            const target = e.target;\n            const command = target.getAttribute('data-command') || target.parentNode.getAttribute('data-command');\n    \n            if (!command) return;\n    \n            const value = target.getAttribute('data-value') || target.parentNode.getAttribute('data-value');\n    \n            const pluginName = this.context.resizing._resize_plugin;\n            const currentContext = this.context[pluginName];\n            const contextEl = currentContext._element;\n            const currentModule = this.plugins[pluginName];\n    \n            e.preventDefault();\n    \n            if (typeof this.plugins.resizing._closeAlignMenu === 'function') {\n                this.plugins.resizing._closeAlignMenu();\n                if (command === 'onalign') return;\n            }\n    \n            switch (command) {\n                case 'auto':\n                    this.plugins.resizing.resetTransform.call(this, contextEl);\n                    currentModule.setAutoSize.call(this);\n                    this.selectComponent(contextEl, pluginName);\n                    break;\n                case 'percent':\n                    let percentY = this.plugins.resizing._module_getSizeY.call(this, currentContext);\n                    if (this.context.resizing._rotateVertical) {\n                        const percentage = contextEl.getAttribute('data-percentage');\n                        if (percentage) percentY = percentage.split(',')[1];\n                    }\n    \n                    this.plugins.resizing.resetTransform.call(this, contextEl);\n                    currentModule.setPercentSize.call(this, (value * 100), (this.util.getNumber(percentY, 0) === null || !/%$/.test(percentY)) ? '' : percentY);\n                    this.selectComponent(contextEl, pluginName);\n                    break;\n                case 'mirror':\n                    const r = contextEl.getAttribute('data-rotate') || '0';\n                    let x = contextEl.getAttribute('data-rotateX') || '';\n                    let y = contextEl.getAttribute('data-rotateY') || '';\n        \n                    if ((value === 'h' && !this.context.resizing._rotateVertical) || (value === 'v' && this.context.resizing._rotateVertical)) {\n                        y = y ? '' : '180';\n                    } else {\n                        x = x ? '' : '180';\n                    }\n        \n                    contextEl.setAttribute('data-rotateX', x);\n                    contextEl.setAttribute('data-rotateY', y);\n        \n                    this.plugins.resizing._setTransForm(contextEl, r, x, y);\n                    break;\n                case 'rotate':\n                    const contextResizing = this.context.resizing;\n                    const slope = (contextEl.getAttribute('data-rotate') * 1) + (value * 1);\n                    const deg = this._w.Math.abs(slope) >= 360 ? 0 : slope;\n        \n                    contextEl.setAttribute('data-rotate', deg);\n                    contextResizing._rotateVertical = /^(90|270)$/.test(this._w.Math.abs(deg).toString());\n                    this.plugins.resizing.setTransformSize.call(this, contextEl, null, null);\n        \n                    this.selectComponent(contextEl, pluginName);\n                    break;\n                case 'onalign':\n                    this.plugins.resizing.openAlignMenu.call(this);\n                    return;\n                case 'align':\n                    const alignValue = value === 'basic' ? 'none' : value;\n                    currentModule.setAlign.call(this, alignValue, null, null, null);\n                    this.selectComponent(contextEl, pluginName);\n                    break;\n                case 'caption':\n                    const caption = !currentContext._captionChecked;\n                    currentModule.openModify.call(this, true);\n                    currentContext._captionChecked = currentContext.captionCheckEl.checked = caption;\n    \n                    currentModule.update_image.call(this, false, false, false);\n    \n                    if (caption) {\n                        const captionText = this.util.getChildElement(currentContext._caption, function (current) {\n                            return current.nodeType === 3;\n                        });\n    \n                        if (!captionText) {\n                            currentContext._caption.focus();\n                        } else {\n                            this.setRange(captionText, 0, captionText, captionText.textContent.length);\n                        }\n    \n                        this.controllersOff();\n                    } else {\n                        this.selectComponent(contextEl, pluginName);\n                        currentModule.openModify.call(this, true);\n                    }\n    \n                    break;\n                case 'revert':\n                    currentModule.setOriginSize.call(this);\n                    this.selectComponent(contextEl, pluginName);\n                    break;\n                case 'update':\n                    currentModule.openModify.call(this);\n                    this.controllersOff();\n                    break;\n                case 'delete':\n                    currentModule.destroy.call(this);\n                    break;\n            }\n    \n            // history stack\n            this.history.push(false);\n        },\n    \n        /**\n         * @description Initialize the transform style (rotation) of the element.\n         * @param {Element} element Target element\n         */\n        resetTransform: function (element) {\n            const size = (element.getAttribute('data-size') || element.getAttribute('data-origin') || '').split(',');\n            this.context.resizing._rotateVertical = false;\n    \n            element.style.maxWidth = '';\n            element.style.transform = '';\n            element.style.transformOrigin = '';\n            element.setAttribute('data-rotate', '');\n            element.setAttribute('data-rotateX', '');\n            element.setAttribute('data-rotateY', '');\n    \n            this.plugins[this.context.resizing._resize_plugin].setSize.call(this, size[0] ? size[0] : 'auto', size[1] ? size[1] : '', true);\n        },\n    \n        /**\n         * @description Set the transform style (rotation) of the element.\n         * @param {Element} element Target element\n         * @param {Number|null} width Element's width size\n         * @param {Number|null} height Element's height size\n         */\n        setTransformSize: function (element, width, height) {\n            let percentage = element.getAttribute('data-percentage');\n            const isVertical = this.context.resizing._rotateVertical;\n            const deg = element.getAttribute('data-rotate') * 1;\n            let transOrigin = '';\n    \n            if (percentage && !isVertical) {\n                percentage = percentage.split(',');\n                if (percentage[0] === 'auto' && percentage[1] === 'auto') {\n                    this.plugins[this.context.resizing._resize_plugin].setAutoSize.call(this);\n                } else {\n                    this.plugins[this.context.resizing._resize_plugin].setPercentSize.call(this, percentage[0], percentage[1]);\n                }\n            } else {\n                const cover = this.util.getParentElement(element, 'FIGURE');\n        \n                const offsetW = width || element.offsetWidth;\n                const offsetH = height || element.offsetHeight;\n                const w = (isVertical ? offsetH : offsetW) + 'px';\n                const h = (isVertical ? offsetW : offsetH) + 'px';\n        \n                this.plugins[this.context.resizing._resize_plugin].cancelPercentAttr.call(this);\n                this.plugins[this.context.resizing._resize_plugin].setSize.call(this, offsetW + 'px', offsetH + 'px', true);\n        \n                cover.style.width = w;\n                cover.style.height = (!!this.context[this.context.resizing._resize_plugin]._caption ? '' : h);\n    \n                if (isVertical) {\n                    let transW = (offsetW/2) + 'px ' + (offsetW/2) + 'px 0';\n                    let transH = (offsetH/2) + 'px ' + (offsetH/2) + 'px 0';\n                    transOrigin = deg === 90 || deg === -270 ? transH : transW;\n                }\n            }\n    \n            element.style.transformOrigin = transOrigin;\n            this.plugins.resizing._setTransForm(element, deg.toString(), element.getAttribute('data-rotateX') || '', element.getAttribute('data-rotateY') || '');\n            \n            if (isVertical) element.style.maxWidth = 'none';\n            else element.style.maxWidth = '';\n    \n            this.plugins.resizing.setCaptionPosition.call(this, element);\n        },\n    \n        _setTransForm: function (element, r, x, y) {\n            let width = (element.offsetWidth - element.offsetHeight) * (/-/.test(r) ? 1 : -1);\n            let translate = '';\n    \n            if (/[1-9]/.test(r) && (x || y)) {\n                translate = x ? 'Y' : 'X';\n    \n                switch (r) {\n                    case '90':\n                        translate = x && y ? 'X' : y ? translate : '';\n                        break;\n                    case '270':\n                        width *= -1;\n                        translate = x && y ? 'Y' : x ? translate : '';\n                        break;\n                    case '-90':\n                        translate = x && y ? 'Y' : x ? translate : '';\n                        break;\n                    case '-270':\n                        width *= -1;\n                        translate = x && y ? 'X' : y ? translate : '';\n                        break;\n                    default:\n                        translate = '';\n                }\n            }\n    \n            if (r % 180 === 0) {\n                element.style.maxWidth = '';\n            }\n            \n            element.style.transform = 'rotate(' + r + 'deg)' + (x ? ' rotateX(' + x + 'deg)' : '') + (y ? ' rotateY(' + y + 'deg)' : '') + (translate ? ' translate' + translate + '(' + width + 'px)' : '');\n        },\n    \n        /**\n         * @description The position of the caption is set automatically.\n         * @param {Element} element Target element (not caption element)\n         */\n        setCaptionPosition: function (element) {\n            const figcaption = this.util.getChildElement(this.util.getParentElement(element, 'FIGURE'), 'FIGCAPTION');\n            if (figcaption) {\n                figcaption.style.marginTop = (this.context.resizing._rotateVertical ? element.offsetWidth - element.offsetHeight : 0) + 'px';\n            }\n        },\n    \n        /**\n         * @description Mouse down event of resize handles\n         * @param {MouseEvent} e Event object \n         */\n        onMouseDown_resize_handle: function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            \n            const contextResizing = this.context.resizing;\n            const direction = contextResizing._resize_direction = e.target.classList[0];\n    \n            contextResizing._resizeClientX = e.clientX;\n            contextResizing._resizeClientY = e.clientY;\n            this.context.element.resizeBackground.style.display = 'block';\n            contextResizing.resizeButton.style.display = 'none';\n            contextResizing.resizeDiv.style.float = /l/.test(direction) ? 'right' : /r/.test(direction) ? 'left' : 'none';\n    \n            const closureFunc_bind = function closureFunc(e) {\n                if (e.type === 'keydown' && e.keyCode !== 27) return;\n    \n                const change = contextResizing._isChange;\n                contextResizing._isChange = false;\n    \n                this.removeDocEvent('mousemove', resizing_element_bind);\n                this.removeDocEvent('mouseup', closureFunc_bind);\n                this.removeDocEvent('keydown', closureFunc_bind);\n                \n                if (e.type === 'keydown') {\n                    this.controllersOff();\n                    this.context.element.resizeBackground.style.display = 'none';\n                    this.plugins[this.context.resizing._resize_plugin].init.call(this);\n                } else {\n                    // element resize\n                    this.plugins.resizing.cancel_controller_resize.call(this, direction);\n                    // history stack\n                    if (change) this.history.push(false);\n                }\n            }.bind(this);\n    \n            const resizing_element_bind = this.plugins.resizing.resizing_element.bind(this, contextResizing, direction, this.context[contextResizing._resize_plugin]);\n            this.addDocEvent('mousemove', resizing_element_bind);\n            this.addDocEvent('mouseup', closureFunc_bind);\n            this.addDocEvent('keydown', closureFunc_bind);\n        },\n    \n        /**\n         * @description Mouse move event after call \"onMouseDown_resize_handle\" of resize handles\n         * The size of the module's \"div\" is adjusted according to the mouse move event.\n         * @param {Object} contextResizing \"core.context.resizing\" object (binding argument)\n         * @param {String} direction Direction (\"tl\", \"tr\", \"bl\", \"br\", \"lw\", \"th\", \"rw\", \"bh\") (binding argument)\n         * @param {Object} plugin \"core.context[currentPlugin]\" object (binding argument)\n         * @param {MouseEvent} e Event object\n         */\n        resizing_element: function (contextResizing, direction, plugin, e) {\n            const clientX = e.clientX;\n            const clientY = e.clientY;\n    \n            let resultW = plugin._element_w;\n            let resultH = plugin._element_h;\n    \n            const w = plugin._element_w + (/r/.test(direction) ? clientX - contextResizing._resizeClientX : contextResizing._resizeClientX - clientX);\n            const h = plugin._element_h + (/b/.test(direction) ? clientY - contextResizing._resizeClientY : contextResizing._resizeClientY - clientY);\n            const wh = ((plugin._element_h / plugin._element_w) * w);\n    \n            if (/t/.test(direction)) contextResizing.resizeDiv.style.top = (plugin._element_h - (/h/.test(direction) ? h : wh)) + 'px';\n            if (/l/.test(direction)) contextResizing.resizeDiv.style.left = (plugin._element_w - w) + 'px';\n    \n            if (/r|l/.test(direction)) {\n                contextResizing.resizeDiv.style.width = w + 'px';\n                resultW = w;\n            }\n    \n            if (/^(t|b)[^h]$/.test(direction)) {\n                contextResizing.resizeDiv.style.height = wh + 'px';\n                resultH = wh;\n            }\n            else if (/^(t|b)h$/.test(direction)) {\n                contextResizing.resizeDiv.style.height = h + 'px';\n                resultH = h;\n            }\n    \n            contextResizing._resize_w = resultW;\n            contextResizing._resize_h = resultH;\n            this.util.changeTxt(contextResizing.resizeDisplay, this._w.Math.round(resultW) + ' x ' + this._w.Math.round(resultH));\n            contextResizing._isChange = true;\n        },\n    \n        /**\n         * @description Resize the element to the size of the \"div\" adjusted in the \"resizing_element\" method.\n         * Called at the mouse-up event registered in \"onMouseDown_resize_handle\".\n         * @param {String} direction Direction (\"tl\", \"tr\", \"bl\", \"br\", \"lw\", \"th\", \"rw\", \"bh\")\n         */\n        cancel_controller_resize: function (direction) {\n            const isVertical = this.context.resizing._rotateVertical;\n            this.controllersOff();\n            this.context.element.resizeBackground.style.display = 'none';\n    \n            let w = this._w.Math.round(isVertical ? this.context.resizing._resize_h : this.context.resizing._resize_w);\n            let h = this._w.Math.round(isVertical ? this.context.resizing._resize_w : this.context.resizing._resize_h);\n    \n            if (!isVertical && !/%$/.test(w)) {\n                const padding = 16;\n                const limit = this.context.element.wysiwygFrame.clientWidth - (padding * 2) - 2;\n                \n                if (this.util.getNumber(w, 0) > limit) {\n                    h = this._w.Math.round((h / w) * limit);\n                    w = limit;\n                }\n            }\n    \n            const pluginName = this.context.resizing._resize_plugin;\n            this.plugins[pluginName].setSize.call(this, w, h, false, direction);\n            if (isVertical) this.plugins.resizing.setTransformSize.call(this, this.context[this.context.resizing._resize_plugin]._element, w, h);\n\n            this.selectComponent(this.context[pluginName]._element, pluginName);\n        }\n    };\n\n    if (typeof noGlobal === typeof undefined) {\n        if (!window.SUNEDITOR_MODULES) {\n            Object.defineProperty(window, 'SUNEDITOR_MODULES', {\n                enumerable: true,\n                writable: false,\n                configurable: false,\n                value: {}\n            });\n        }\n\n        Object.defineProperty(window.SUNEDITOR_MODULES, 'resizing', {\n            enumerable: true,\n            writable: false,\n            configurable: false,\n            value: resizing\n        });\n    }\n\n    return resizing;\n}));"]},"metadata":{},"sourceType":"script"}